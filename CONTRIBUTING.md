# 贡献指南

感谢您对 DeZero 项目的兴趣！我们欢迎各种形式的贡献，包括代码、文档、测试和错误报告。

## 目录

- [行为准则](#行为准则)
- [如何贡献](#如何贡献)
- [报告错误](#报告错误)
- [提交拉取请求](#提交拉取请求)
- [开发指南](#开发指南)
- [代码风格](#代码风格)
- [提交消息规范](#提交消息规范)

## 行为准则

### 我们的承诺

为了建立一个开放包容的环境，我们承诺：

- 尊重所有参与者，不论其身份、外表、信仰或经验
- 接纳建设性的批评
- 关注对项目最有益的事情

### 不可接受的行为

以下行为不可接受：

- 使用带有性暗示的语言或图像
- 人身攻击
- 骚扰或跟踪
- 在没有同意的情况下披露他人隐私信息
- 其他被视为不专业或不欢迎的行为

## 如何贡献

### 1. 报告错误

在报告错误前，请检查 [Issues](https://github.com/yourusername/DeZero/issues) 是否已有相同的报告。

**提交错误报告时，请包括：**

- 清晰的标题和描述
- 尽可能详细的重现步骤
- 代码示例或演示文件
- 您的环境信息（Python版本、OS等）
- 任何相关的日志或错误消息

### 2. 建议功能

我们欢迎功能建议。提交建议时：

- 使用清晰的标题
- 提供详细的描述
- 列出一些可能的用例
- 解释为什么这对项目有帮助

### 3. 改进文档

文档改进总是欢迎的！您可以：

- 修复拼写或语法错误
- 改进文档的清晰度
- 添加新的示例
- 翻译文档

### 4. 提交代码

最好在开始大的功能开发前，先打开一个 Issue 讨论您的想法。

## 报告错误

### 创建一个高质量的错误报告

错误报告有助于我们快速诊断和修复问题。遵循以下指导：

**使用清晰的标题和描述**

- 不要使用如"不工作"或"问题"这样模糊的标题

**提供具体示例来重现问题**

```python
# 示例：
import dezero
x = dezero.Variable(...)  # 您的代码
```

**描述观察到的行为和预期行为**

- 解释您看到的行为
- 解释您期望看到的行为

**包含屏幕截图和日志**

- 如果适用，粘贴完整的错误跟踪
- 显示控制台输出

**指定您的环境**

```
- Python版本: 3.8/3.9/3.10
- 操作系统: Windows/macOS/Linux
- DeZero版本: 0.1.0
```

## 提交拉取请求

### 开发工作流

1. **Fork 项目**
   ```bash
   git clone https://github.com/yourusername/DeZero.git
   cd DeZero
   ```

2. **创建分支**
   ```bash
   # 从main分支创建
   git checkout -b feature/your-feature-name
   ```

3. **进行更改**
    - 确保代码符合项目风格
    - 添加或更新文档
    - 添加测试代码

4. **测试您的更改**
   ```bash
   # 运行测试
   python -m pytest tests/
   ```

5. **提交更改**
   ```bash
   git add .
   git commit -m "描述您的更改"
   git push origin feature/your-feature-name
   ```

6. **提交拉取请求**
    - 访问项目页面
    - 点击"新建拉取请求"
    - 填写PR描述
    - 提交PR

### PR 检查清单

在提交 PR 前，请确保：

- [ ] 我已更新相关文档
- [ ] 我已添加测试来覆盖新功能或修复
- [ ] 新旧测试都通过
- [ ] 我的代码遵循项目风格指南
- [ ] 我的提交消息遵循提交规范
- [ ] 我已从上游main分支同步代码

### PR 描述模板

```markdown
## 描述
简明扼要地描述您的更改。

## 相关问题
关闭 #(issue)

## 更改类型
- [ ] Bug修复
- [ ] 新功能
- [ ] 文档更新
- [ ] 其他（请说明）

## 测试
描述您进行的测试。

## 截图（如适用）
添加任何相关的截图。
```

## 开发指南

### 设置开发环境

```bash
# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装开发依赖
pip install -e .
pip install -r requirements-dev.txt
```

### 运行测试

```bash
# 运行所有测试
python -m pytest

# 运行特定测试文件
python -m pytest tests/test_core.py

# 运行带覆盖率的测试
python -m pytest --cov=dezero tests/
```

### 构建文档

```bash
# 如果使用Sphinx
cd docs/
make html
```

## 代码风格

我们遵循 PEP 8 编码风格。

### 关键要点

**格式化**

- 使用 4 个空格缩进
- 行长不超过 100 字符
- 在操作符周围使用空格：`x = y + z`

**命名**

- 函数和变量使用 `snake_case`
- 类使用 `PascalCase`
- 常数使用 `UPPER_CASE`

**文档字符串**

```python
def function_name(param1, param2):
    """
    简短描述。

    详细描述（如果需要）。

    Args:
        param1: 参数1的描述
        param2: 参数2的描述

    Returns:
        返回值的描述

    Raises:
        ValueError: 何时抛出此异常
    """
    pass
```

**注释**

- 使用有意义的注释解释复杂的逻辑
- 注释应该解释 *为什么*，而不是 *什么*
- 保持注释与代码同步

### 工具

我们使用以下工具维护代码质量：

```bash
# 使用pylint检查代码质量
pylint dezero/

# 使用yapf格式化代码
yapf -r -i dezero/

# 使用flake8检查风格
flake8 dezero/
```

## 提交消息规范

遵循以下格式来写有意义的提交消息：

```
<类型>(<范围>): <主题>

<正文>

<页脚>
```

### 类型

- **feat**: 新功能
- **fix**: 错误修复
- **docs**: 文档修改
- **style**: 代码风格修改（不影响功能）
- **refactor**: 代码重构
- **perf**: 性能优化
- **test**: 添加或修改测试
- **chore**: 构建、依赖或工具修改

### 示例

```
feat(autograd): 添加更高阶导数支持

- 实现了高阶导数计算
- 添加了backward参数create_graph
- 添加相关测试

Closes #123
```

### 最佳实践

- 使用命令式、现在时态："add feature"而不是"added feature"
- 不要以句号结尾
- 限制主题行为 50 个字符
- 正文每行 72 个字符
- 在正文中解释*什么*和*为什么*，而不是*如何*

## 其他

### 获得帮助

- 查看现有 [Issues](https://github.com/yourusername/DeZero/issues)
- 阅读 [文档](./README.md)
- 在讨论中提问

### 认可

贡献者将在项目中得到认可。感谢您的支持！

---

感谢您的贡献！🎉

